{% extends "core/base.html" %}

{% block title %}
Index
{% endblock title %}
{% load static %}
{% block content %}
<script src="{% static 'Core/searchfunctionality.js' %}" defer></script>

<main id="homeWrapper">
    <header id="searchNav">
        <form action="{% url 'collabs:collab_list' %}" method="get">
            <input type="text" name="search" placeholder="search for a collab" maxlength="100" id="searchBar" value="{{ request.GET.search }}">
        </form>

        <form method="get" id="tagFilterForm">
            <button id="toggleListButton" class="btn" onclick="showTagList()" type="button">Toggle Tags â–½</button>
            <span class="vertical_list">
                {% for collab, main_image in collabs_withImg %}
                    {% for tag in collab.tags.all %}
                    <span>  
                            <label for="tag_{{ tag.id }}">{{ tag.name }}<input type="checkbox" id="tag_{{ tag.id }}" name="tags" value="{{ tag.id }}"></label>
                    </span>  
                    {% endfor %}
                {% endfor %}
            </span>
        </form>
    </header>

    <article id="collabListWrapper">
    {% for collab, main_image in collabs_withImg %}
        <a href="{% url 'collabs:collab' collab.id %}" id="collabInfoBar">
                <section id="collabInfoBarHeader">
                    <h2>{{ collab.title }}</h2>
                </section>
                <section class="collabInfoBarWrapper">
                    {% if main_image.image.name %}
                    <img src="{{ main_image.image.url }}" alt="" onerror="this.style.display='none'">
                    {% else %}
                    <span> {{ collab.introduction }} </span>
                    {% endif %}
                </section>
                <section class="collabInfoBarWrapper" id="tagsBox">
                <h2>Tags:</h2>
                    <ul>
                        {% for tag in collab.tags.all %}
                            <li>{{ tag.name }}</li>
                        {% endfor %}
                    </ul>
                </section>
                <p>Created: {{ collab.created_at }}</p>
        </a>  
    
    {% empty %}
        <p>No collaborations to display.</p>
    {% endfor %}

    </article>
</main>
{% endblock %}